<h2>{{t "workItemList.instance.currentTasks"}}</h2>

<div class="workitemlist-filters">
  <div>
    <div class="filters-wrapper">
      <input {{on "click" (fn this.updateFilter "role" "active")}} value="active" checked={{eq this.role "active"}} type="radio" class="filter-button" name="role" id="filter-active"/>
      <label for="filter-active">{{t "workItemList.all.filter.active"}}</label>
      <input {{on "click" (fn this.updateFilter "role" "control")}} value="control" checked={{eq this.role "control"}} type="radio" class="filter-button" name="role" id="filter-control"/>
      <label for="filter-control">{{t "workItemList.all.filter.control"}}</label>
    </div>
  </div>
</div>

<table {{did-insert (perform this.fetchWorkItems)}}>
  <thead>
    <th>{{t "workItemList.task"}}</th>
    <th>{{t "workItemList.deadline"}}</th>
    <th>{{t "workItemList.created"}}</th>
    <th>{{t "workItemList.responsible"}}</th>
    <th>{{t "workItemList.addressedGroups"}}</th>
  </thead>
  <tbody>
    {{#if this.workItemsQuery.isLoading}}
      <tr>
        <td colspan="5"><LoadingText /></td>
      </tr>
    {{else}}
      {{#each this.activeWorkItems as |workItem|}}
        <tr>
          <td>{{workItem.name}}</td>
          <td>{{moment-from workItem.deadline}}</td>
          <td>
            {{format-date
              workItem.createdAt
              day="2-digit"
              month="2-digit"
              year="numeric"
              hour="2-digit"
              minute="2-digit"
              hour12=false
            }}
          </td>
          <td>
            {{#each workItem.assignedUserInformation as |user|}}
              {{user.fullName}}
            {{else}}
              -
            {{/each}}
          </td>
          <td>
            {{#each workItem.assignedServices as |service|}}
              {{service.name}}
            {{else}}
              -
            {{/each}}
          </td>
        </tr>
      {{else}}
        <tr>
          <td colspan="5">{{t "workItemList.empty"}}</td>
        </tr>
      {{/each}}
    {{/if}}
  </tbody>
</table>
<button class="button" type="button">{{t "workItemList.instance.newTask"}}</button>

<h2>{{t "workItemList.instance.finishedTasks"}}</h2>
<table>
  <thead>
    <th>{{t "workItemList.task"}}</th>
    <th>{{t "global.date"}}</th>
    <th>{{t "global.user"}}</th>
  </thead>
  <tbody>
    {{#if this.workItemsQuery.isLoading}}
      <tr>
        <td colspan="3"><LoadingText /></td>
      </tr>
    {{else}}
      {{#each this.doneWorkItems as |workitem|}}
          <tr>
            <td>{{workitem.name}}</td>
            <td>
              {{format-date
                workitem.closedAt
                day="2-digit"
                month="2-digit"
                year="numeric"
                hour="2-digit"
                minute="2-digit"
                hour12=false
              }}
            </td>
            <td>{{workitem.closedByUser.fullName}}</td>
          </tr>
      {{else}}
        <tr>
          <td colspan="3">{{t "workItemList.empty"}}</td>
        </tr>
      {{/each}}
    {{/if}}
  </tbody>
</table>