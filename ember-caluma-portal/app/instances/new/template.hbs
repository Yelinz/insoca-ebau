<h1 class="uk-text-center">{{t "instances.new.title"}}</h1>

<p class="uk-text-center uk-text-large">{{t "instances.new.kind"}}</p>

{{#let (can "create paper instance") as |isPaper|}}
  {{#if isPaper}}
    <div class="uk-flex uk-flex-center uk-margin-large-top">
      <div class="uk-alert uk-alert-warning uk-width-large">
        <strong>{{t "paper.noteTitle"}}</strong> {{t "paper.noteBody"}}
      </div>
    </div>
  {{/if}}

  <div uk-grid class="uk-grid-small uk-child-width-1-1 uk-child-width-1-3@s uk-margin-bottom uk-margin-large-top">
    <div class="uk-text-center">
      <p class="uk-flex-inline uk-text-large uk-flex-middle">
        {{t "instances.new.preClarification"}}
        <CfField::info @text={{t "instances.new.preClarificationInfo"}} />
      </p>
      <div>
        {{#each forms.lastSuccessful.value.preliminary-clarification as |form|}}
          <UkButton
            @width="1-1"
            @label={{concat form.name " " (if isPaper (concat "(" (t "paper.type") ")"))}}
            @color={{if (eq form.slug this.selectedForm) "secondary" "default"}}
            @on-click={{fn (mut this.selectedForm) form.slug}}

            class="uk-margin-small-bottom"
          />
        {{/each}}
      </div>
    </div>
    <div class="uk-text-center">
      <p class="uk-flex-inline uk-text-large uk-flex-middle">
        {{t "instances.new.application"}}
        <CfField::info @text={{t "instances.new.applicationInfo"}} />
      </p>
      <div>
        {{#each forms.lastSuccessful.value.building-permit as |form|}}
          <UkButton
            @width="1-1"
            @label={{concat form.name " " (if isPaper (concat "(" (t "paper.type") ")"))}}
            @color={{if (eq form.slug this.selectedForm) "secondary" "default"}}
            @on-click={{fn (mut this.selectedForm) form.slug}}

            class="uk-margin-small-bottom"
          />
        {{/each}}
      </div>
    </div>
    <div class="uk-text-center">
      <p class="uk-flex-inline uk-text-large uk-flex-middle">
        {{t "instances.new.specialProcedure"}}
      </p>
      <div>
        {{#each forms.lastSuccessful.value.special-procedure as |form|}}
          <UkButton
            @width="1-1"
            @label={{concat form.name " " (if isPaper (concat "(" (t "paper.type") ")"))}}
            @color={{if (eq form.slug this.selectedForm) "secondary" "default"}}
            @on-click={{fn (mut this.selectedForm) form.slug}}

            class="uk-margin-small-bottom"
          />
        {{/each}}
      </div>
    </div>
  </div>

  <div class="uk-text-right">
    <UkButton
      @color="primary"
      @label={{t "global.continue"}}
      @disabled={{or (not this.selectedForm) this.save.isRunning}}
      @loading={{this.save.isRunning}}
      @on-click={{perform save}}
    />
  </div>
{{/let}}
