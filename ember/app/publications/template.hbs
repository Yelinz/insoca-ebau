<h1>Publikationen</h1>
<table class="uk-table uk-table-striped uk-table-hover uk-table-responsive">
  <thead>
    <tr>
      <th>Gesuchsnummer</th>
      <th>Beschreibung</th>
      <th>Gemeinde</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {{#if publications.isRunning}}
      <tr>
        <td class="uk-text-center" colspan="5">{{uk-spinner}}</td>
      </tr>
    {{else}}
      {{#each publicationList as |publication|}}
        <tr>
          <td>
            {{#if (eq publication.status "accepted")}}
              <a
                title="Klicken Sie um das Gesuch anzuschauen"
                {{action (perform navigate) publication.instance on='click'}}
              >{{publication.instance.identifier}}</a>
            {{else}}
              {{publication.instance.identifier}}
            {{/if}}
          </td>
          <td>
            {{publication.description}}
          </td>
          <td>
            {{publication.instance.location.name}}
          </td>
          <td>
            {{#if (eq publication.status "pending")}}
              <span class="uk-icon-button" uk-icon="clock" title="Die Gemeinde bearbeitet ihre Anfrage"></span>
            {{else if (eq publication.status "accepted")}}
              <button
                title="Klicken Sie um das Gesuch anzuschauen"
                class="uk-icon-button"
                uk-icon="file-text"
                onclick={{action (perform navigate) publication.instance}}></button>
            {{else if (eq publication.status "denied")}}
              <span class="uk-icon-button" uk-icon="minus-circle" title="Ihnen wurde der Zugriff verwiesen"></span>
            {{else}}
            {{!--
            <button title="Zugriff anfordern" class="uk-icon-button" uk-icon="pull" uk-toggle="target: #modal-publication"></button>
            --}}
            <button title="Zugriff anfordern" class="uk-icon-button" uk-icon="pull" onclick={{perform requestPermission publication}}></button>
            {{/if}}
          </td>
        </tr>
      {{else}}
        <tr>
          <td class="uk-text-center" colspan="4">Keine laufende Publikation vorhanden</td>
        </tr>
      {{/each}}
    {{/if}}
  </tbody>
</table>

<div id="modal-publication" uk-modal>
  <div class="uk-modal-dialog uk-modal-body">
    <form {{action (perform requestPermission) on='submit'}}>
      <button type="button" class="uk-modal-close-default" uk-close></button>

      <h2 class="uk-modal-title">Zugriff zur Publikation anfordern</h2>

      <div class="uk-margin">
        <label class="uk-form-label uk-text-bolder">
          Mitteilung
        </label>
        {{textarea class="uk-textarea"}}
      </div>

      <div class="uk-text-right">
        {{#uk-button class="uk-modal-close"}}Abbrechen{{/uk-button}}
        {{#uk-button loading=requestPermission.isRunning color='primary' type='submit'}}Anfragen{{/uk-button}}
      </div>
    </form>
  </div>
</div>
